<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="TrafficEscapeGame.MainPage" Title="Traffic Escape!"
             xmlns:local="clr-namespace:TrafficEscapeGame">

    <ContentPage.Resources>
        <ResourceDictionary>
            <Style TargetType="Button">
                <Setter Property="Background" Value="ForestGreen" />
                <Setter Property="TextColor" Value="White" />
                <Setter Property="FontAttributes" Value="Bold" />
                <Setter Property="CornerRadius" Value="10" />
                <Setter Property="Padding" Value="10"/>
            </Style>
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid x:Name="MainGrid" BackgroundColor="DarkRed">

        <Grid x:Name="GameOverLay" HorizontalOptions="Center" 
               VerticalOptions="Center" IsVisible="True" 
               BackgroundColor="DarkOrange" Padding="20"
               ZIndex="2" >

            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Label 
                Text="Traffic Escape Game" 
                FontSize="Large" 
                Grid.Row="0"/>
            <Image 
                Source="trafficescapelogo.png" 
                HeightRequest="100"
                WidthRequest="100"
                Grid.Row="1"
                Margin="20"/>
            <HorizontalStackLayout 
                Grid.Row="2"
                Spacing="20">
                <Button
                         x:Name="InstructionsBtn"
                         Text="Instructions" 
                         Clicked="OnInstructionsBtn_Clicked"
                         HorizontalOptions="Start"/>

                <Button
                         x:Name="StartGameBtn"
                         Text="Start Game" 
                         Clicked="OnStartBtn_Clicked"
                         HorizontalOptions="Center"/>

                <Button
                         x:Name="HighScoreBtn"
                         Text="High Score"
                         Clicked="HighScoreBtn_Clicked"
                         HorizontalOptions="End"/>
            </HorizontalStackLayout>
        </Grid>

        <!--ROAD canvas -->
        <AbsoluteLayout x:Name="GameCanvas"
                IsVisible="False"
                HorizontalOptions="Fill"
                VerticalOptions="Fill"
                BackgroundColor="LightSkyBlue"
                ZIndex="0">

            <AbsoluteLayout.GestureRecognizers>
                <TapGestureRecognizer Tapped="TapGestureRecognizer_Tapped"/>
                <SwipeGestureRecognizer Direction="Left, Right" Swiped="SwipeGestureRecognizer_Swiped"/>
            </AbsoluteLayout.GestureRecognizers>

            <!-- ROAD pair (stacked vertically, Y of second starts at 1 so we can scroll) -->
            <BoxView x:Name="Road1"
                 BackgroundColor="Gray"
                 AbsoluteLayout.LayoutFlags="All"  
                 AbsoluteLayout.LayoutBounds="0.5, 1, 0.75, 1"
                 ZIndex="0"/>

            <BoxView x:Name="Road2"
                 BackgroundColor="Gray"
                 AbsoluteLayout.LayoutFlags="All"  
                 AbsoluteLayout.LayoutBounds="0.5, 1, 0.75, 1"
                 ZIndex="0"/>

            <!-- Lane markers — thin vertical strips that span the road height (positioned proportionally within the road) -->
            <BoxView x:Name="LeftLane1"
                 BackgroundColor="White"
                 AbsoluteLayout.LayoutFlags="All"
                 AbsoluteLayout.LayoutBounds="0.375, 0, 0.02, 1"
                 ZIndex="0"/>

            <BoxView x:Name="LeftLane2"
                 BackgroundColor="White"
                 AbsoluteLayout.LayoutFlags="All"
                 AbsoluteLayout.LayoutBounds="0.375, 1, 0.02, 1"
                 ZIndex="0"/>

            <BoxView x:Name="RightLane1"
                 BackgroundColor="White"
                 AbsoluteLayout.LayoutFlags="All"
                 AbsoluteLayout.LayoutBounds="0.625, 0, 0.02, 1"
                 ZIndex="0"/>

            <BoxView x:Name="RightLane2"
                 BackgroundColor="White"
                 AbsoluteLayout.LayoutFlags="All"
                 AbsoluteLayout.LayoutBounds="0.625, 1, 0.02, 1"
                 ZIndex="0"/>

            <!-- Header / HUD: ensure this is above the road -->
            <VerticalStackLayout AbsoluteLayout.LayoutFlags="All" AbsoluteLayout.LayoutBounds="0,0,1,1" Padding="10" InputTransparent="True"  BackgroundColor="LightSkyBlue" x:Name="vs">
                <Label x:Name="ScoreLbl" Text="Distance: 0" FontSize="Large" TextColor="Black"/>
                <Label x:Name="CoinsLbl" Text="Coins: 0" FontSize="Large" TextColor="Yellow"/>
                <Button x:Name="QuitBtn" Text="Quit" Padding="10" Clicked="OnExitBtn_Clicked" HorizontalOptions="Start" BackgroundColor="Black" TextColor="White"/>
            </VerticalStackLayout>

            <Image x:Name="PlayerCar" IsVisible="False"
               Source="bluecar.png"
               WidthRequest="120"
               HeightRequest="120"
               AbsoluteLayout.LayoutFlags="PositionProportional"
               AbsoluteLayout.LayoutBounds="0.5, 0.9, AutoSize, AutoSize"
               ZIndex="1" />

            <Label x:Name="CountdownLbl"
               Text="3"
               FontSize="200"
               TextColor="YellowGreen"
               HorizontalTextAlignment="Center"
               VerticalTextAlignment="Center"
               AbsoluteLayout.LayoutFlags="All"
               AbsoluteLayout.LayoutBounds="0.5, 0.5, 0.5, 0.5"  
               IsVisible="False"
               ZIndex="3" />

        </AbsoluteLayout>

    </Grid>

</ContentPage>